import{a as W,b as E,c as K,d as Q,e as J,f as H,g as X,h as Z,i as ee,j as te,k as re,l as ne,m as ie}from"./chunk-Q73HPW4N.js";import{b as B,c as G,d as L,g as U}from"./chunk-WS2GNBT7.js";import{Ea as N,Ia as m,Sa as q,Va as c,Wa as o,Xa as r,Y as b,Ya as O,Z as h,bb as j,cb as w,db as d,eb as M,fb as C,gb as a,hb as y,ib as x,jb as z,ta as s,ya as V}from"./chunk-3LP2OGE5.js";var D=(function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n})(D||{});function P(n,t){return{type:D.Trigger,name:n,definitions:t,options:{}}}function R(n,t=null){return{type:D.Animate,styles:t,timings:n}}function k(n){return{type:D.Style,styles:n,offset:null}}function T(n,t,e=null){return{type:D.Transition,expr:n,animation:t,options:e}}function $(n,t,e=null){return{type:D.Query,selector:n,animation:t,options:e}}function Y(n,t){return{type:D.Stagger,timings:n,animation:t}}function se(n,t){if(n&1&&(o(0,"div",34)(1,"span",35),a(2,"\u26A0\uFE0F"),r(),a(3),r()),n&2){let e=d(2);s(3),x(" ",e.getErrorMessage("totalAmount")," ")}}function le(n,t){if(n&1&&(o(0,"div",34)(1,"span",35),a(2,"\u26A0\uFE0F"),r(),a(3),r()),n&2){let e=d(2);s(3),x(" ",e.getErrorMessage("numberOfFloors")," ")}}function de(n,t){if(n&1){let e=j();o(0,"div",16)(1,"div",17)(2,"h2",18),a(3,"\u{1F4CB} Informaci\xF3n General"),r(),o(4,"p",19),a(5,"Ingresa el monto total de la factura y el n\xFAmero de pisos del edificio"),r()(),o(6,"form",20)(7,"div",21)(8,"label",22),a(9," \u{1F4B0} Total de la Factura de Agua "),r(),o(10,"div",23)(11,"span",24),a(12,"$"),r(),o(13,"input",25),w("blur",function(){b(e);let l=d();return h(l.onFieldChange("totalAmount"))})("input",function(){b(e);let l=d();return h(l.onFieldChange("totalAmount"))}),r()(),m(14,se,4,1,"div",26),o(15,"div",27)(16,"span",28),a(17,"\u{1F4A1}"),r(),a(18," Ingresa el valor total sin comas ni puntos adicionales "),r()(),o(19,"div",21)(20,"label",29),a(21," \u{1F3E2} N\xFAmero de Pisos "),r(),o(22,"div",23)(23,"input",30),w("blur",function(){b(e);let l=d();return h(l.onFieldChange("numberOfFloors"))})("input",function(){b(e);let l=d();return h(l.onFieldChange("numberOfFloors"))}),r()(),m(24,le,4,1,"div",26),o(25,"div",27)(26,"span",28),a(27,"\u{1F4A1}"),r(),a(28," M\xE1ximo 20 pisos permitidos "),r()(),o(29,"div",31)(30,"button",32),w("click",function(){b(e);let l=d();return h(l.onNextStep())}),o(31,"span",33),a(32,"\u{1F465}"),r(),a(33," Continuar a Pisos "),r()()()()}if(n&2){let e=d();s(6),c("formGroup",e.aguaForm),s(4),C("error",e.hasError("totalAmount")),s(4),c("ngIf",e.hasError("totalAmount")),s(8),C("error",e.hasError("numberOfFloors")),s(2),c("ngIf",e.hasError("numberOfFloors")),s(6),c("disabled",!e.isStep1Valid())}}function ue(n,t){n&1&&(o(0,"span"),a(1,"\u2705"),r())}function ce(n,t){n&1&&(o(0,"span"),a(1,"\u274C"),r())}function pe(n,t){if(n&1&&(o(0,"div",34)(1,"span",35),a(2,"\u26A0\uFE0F"),r(),a(3),r()),n&2){let e=d().index,i=d(2);s(3),x(" ",i.getErrorMessage("people",e)," ")}}function me(n,t){if(n&1&&(o(0,"div",34)(1,"span",35),a(2,"\u26A0\uFE0F"),r(),a(3),r()),n&2){let e=d().index,i=d(2);s(3),x(" ",i.getErrorMessage("adjustment",e)," ")}}function fe(n,t){n&1&&(o(0,"div",27)(1,"span",28),a(2,"\u{1F504}"),r(),a(3," Esta reducci\xF3n se redistribuir\xE1 autom\xE1ticamente "),r())}function ge(n,t){if(n&1&&(o(0,"div",34)(1,"span",35),a(2,"\u26A0\uFE0F"),r(),a(3),r()),n&2){let e=d().index,i=d(2);s(3),x(" ",i.getErrorMessage("adjustmentReason",e)," ")}}function ve(n,t){if(n&1){let e=j();o(0,"div",46)(1,"div",47)(2,"div",48)(3,"span",49),a(4,"\u{1F3E0}"),r(),a(5),r(),o(6,"div",50),m(7,ue,2,0,"span",51)(8,ce,2,0,"span",51),r()(),o(9,"div",52)(10,"div",21)(11,"label",53),a(12," \u{1F464} Cantidad de Personas "),r(),o(13,"div",54)(14,"input",55),w("blur",function(){let l=b(e).index,p=d(2);return h(p.onFieldChange("people",l))})("input",function(){let l=b(e).index,p=d(2);return h(p.onFieldChange("people",l))}),r()(),m(15,pe,4,1,"div",26),r(),o(16,"div",21)(17,"label",53),a(18," \u2696\uFE0F Ajuste Manual "),o(19,"span",56),a(20,"(+ aumentar / - reducir)"),r()(),o(21,"div",54)(22,"span",57),a(23,"$"),r(),o(24,"input",58),w("blur",function(){let l=b(e).index,p=d(2);return h(p.onFieldChange("adjustment",l))})("input",function(){let l=b(e).index,p=d(2);return h(p.onFieldChange("adjustment",l))}),r()(),m(25,me,4,1,"div",26)(26,fe,4,0,"div",59),r(),o(27,"div",21)(28,"label",53),a(29," \u{1F4DD} Motivo del Ajuste (Opcional) "),r(),o(30,"input",60),w("blur",function(){let l=b(e).index,p=d(2);return h(p.onFieldChange("adjustmentReason",l))}),r(),o(31,"div",27)(32,"span",28),a(33,"\u{1F4A1}"),r(),a(34," Ayuda a recordar por qu\xE9 se aplic\xF3 este ajuste "),r(),m(35,ge,4,1,"div",26),r()()()}if(n&2){let e,i,l,p,A,f=t.$implicit,v=t.index,_=d(2);c("formGroup",f),q("data-floor",v+1),s(5),x(" Piso ",(e=f.get("floorNumber"))==null?null:e.value," "),s(),C("valid",!_.hasError("people",v)&&((i=f.get("people"))==null?null:i.value)>0),s(),c("ngIf",!_.hasError("people",v)&&((l=f.get("people"))==null?null:l.value)>0),s(),c("ngIf",_.hasError("people",v)),s(5),C("error",_.hasError("people",v))("success",!_.hasError("people",v)&&((p=f.get("people"))==null?null:p.value)>0),s(2),c("ngIf",_.hasError("people",v)),s(6),C("error",_.hasError("adjustment",v)),s(4),c("ngIf",_.hasError("adjustment",v)),s(),c("ngIf",((A=f.get("adjustment"))==null?null:A.value)<0),s(9),c("ngIf",_.hasError("adjustmentReason",v))}}function be(n,t){n&1&&(o(0,"span",61)(1,"span",33),a(2,"\u{1F9EE}"),r(),a(3," Calcular con Redistribuci\xF3n "),r())}function he(n,t){n&1&&(o(0,"span",62),O(1,"span",63),a(2," Calculando... "),r())}function xe(n,t){if(n&1){let e=j();o(0,"div",36)(1,"div",17)(2,"h2",18),a(3,"\u{1F465} Personas por Piso"),r(),o(4,"p",19),a(5,"Ingresa la cantidad de personas y ajustes por consumo para cada piso"),r(),o(6,"div",37)(7,"div",38),a(8," \u2139\uFE0F Los ajustes negativos se redistribuir\xE1n autom\xE1ticamente entre los dem\xE1s pisos "),r()()(),o(9,"form",20)(10,"div",39),m(11,ve,36,17,"div",40),r(),o(12,"div",41)(13,"button",42),w("click",function(){b(e);let l=d();return h(l.onPreviousStep())}),o(14,"span",33),a(15,"\u2190"),r(),a(16," Anterior "),r(),o(17,"button",43),w("click",function(){b(e);let l=d();return h(l.onNextStep())}),m(18,be,4,0,"span",44)(19,he,3,0,"span",45),r()()()()}if(n&2){let e=d();s(9),c("formGroup",e.aguaForm),s(2),c("ngForOf",e.floorFormGroups),s(6),C("loading",e.isCalculating),c("disabled",!e.isStep2Valid()||e.isCalculating),s(),c("ngIf",!e.isCalculating),s(),c("ngIf",e.isCalculating)}}function _e(n,t){if(n&1&&(o(0,"div",71)(1,"div",66),a(2,"\u{1F504}"),r(),o(3,"div",67)(4,"div",68),a(5),r(),o(6,"div",69),a(7,"Redistribuido"),r()()()),n&2){let e=d(2);s(5),y(e.formatCurrency(e.calculation.redistributionDetails.totalRedistributed))}}function ye(n,t){if(n&1&&(o(0,"div",37)(1,"div",38),a(2," \u{1F504} "),o(3,"strong"),a(4,"Redistribuci\xF3n Autom\xE1tica:"),r(),a(5),r()()),n&2){let e=d(2);s(5),x(" ",e.getRedistributionInfo()," ")}}function we(n,t){n&1&&(o(0,"span",108),a(1,"Reducci\xF3n"),r())}function Ee(n,t){n&1&&(o(0,"span",109),a(1,"+Redistribuci\xF3n"),r())}function Ce(n,t){if(n&1&&(o(0,"small",113),a(1),r()),n&2){let e=d(2).$implicit;s(),y(e.adjustmentReason)}}function Fe(n,t){if(n&1&&(o(0,"div",110)(1,"span",101)(2,"span",111),a(3),r(),m(4,Ce,2,1,"small",112),r(),o(5,"span",102),a(6),r()()),n&2){let e=d().$implicit,i=d(2);s(3),x("",e.adjustment>0?"Ajuste (+)":"Reducci\xF3n (-)",":"),s(),c("ngIf",e.adjustmentReason),s(),C("positive",e.adjustment>0)("negative",e.adjustment<0),s(),x(" ",i.formatCurrency(e.adjustment)," ")}}function Se(n,t){if(n&1&&(o(0,"div",114)(1,"span",115),a(2," Redistribuci\xF3n recibida: "),r(),o(3,"span",116),a(4),r()()),n&2){let e=d().$implicit,i=d(2);s(4),x(" +",i.formatCurrency(e.redistributedAmount)," ")}}function De(n,t){if(n&1&&(o(0,"div",89)(1,"div",90)(2,"div",91)(3,"span",92)(4,"span",93),a(5,"\u{1F3E0}"),r(),a(6),r(),o(7,"span",94),a(8),r(),o(9,"div",95),m(10,we,2,0,"span",96)(11,Ee,2,0,"span",97),r()(),o(12,"div",98),a(13),r()(),o(14,"div",99)(15,"div",100)(16,"span",101),a(17),r(),o(18,"span",102),a(19),r()(),m(20,Fe,7,7,"div",103)(21,Se,5,1,"div",104),o(22,"div",105)(23,"span",101)(24,"strong"),a(25,"Total a pagar:"),r()(),o(26,"span",102)(27,"strong"),a(28),r()()(),o(29,"div",106)(30,"small",107),a(31),r()()()()),n&2){let e=t.$implicit,i=t.index,l=d(2);M("animation-delay",i*.1+"s"),s(6),x(" Piso ",e.floorNumber," "),s(2),z("",e.people," persona",e.people!==1?"s":""),s(2),c("ngIf",e.adjustment<0),s(),c("ngIf",e.redistributedAmount&&e.redistributedAmount>0),s(2),y(l.formatCurrency(e.finalAmount)),s(4),z("Base (",e.people," \xD7 ",l.formatCurrency(l.calculation.baseAmountPerPerson),"):"),s(2),y(l.formatCurrency(e.baseAmount)),s(),c("ngIf",e.adjustment!==0),s(),c("ngIf",e.redistributedAmount&&e.redistributedAmount>0),s(7),y(l.formatCurrency(e.finalAmount)),s(3),y(l.getFloorBreakdown(e))}}function Ae(n,t){if(n&1&&(o(0,"div",117),a(1),r()),n&2){let e=d(2);s(),x(" (Incluye ",e.formatCurrency(e.calculation.totalAdjustments)," en ajustes) ")}}function ke(n,t){if(n&1&&(o(0,"div",118),a(1),r()),n&2){let e=d(2);s(),x(" Con ",e.formatCurrency(e.calculation.redistributionDetails.totalRedistributed)," redistribuidos autom\xE1ticamente ")}}function je(n,t){if(n&1&&(o(0,"span",119),a(1),r()),n&2){let e=d(2);s(),z(" \u2705 Balance perfecto: ",e.formatCurrency(e.calculation.totalAmount)," = ",e.formatCurrency(e.calculation.finalTotal)," ")}}function Ie(n,t){if(n&1&&(o(0,"span",119),a(1),r()),n&2){let e=d(2);s(),x(" \u26A0\uFE0F Diferencia m\xEDnima: ",e.formatCurrency(e.Math.abs(e.getTotalDifference()))," (redondeo) ")}}function ze(n,t){if(n&1&&(o(0,"div",120)(1,"h4",121),a(2,"\u{1F4C8} Estad\xEDsticas"),r(),o(3,"div",122)(4,"div",123)(5,"span",124),a(6,"Pisos con ajustes:"),r(),o(7,"span",125),a(8),r()(),o(9,"div",123)(10,"span",124),a(11,"Pisos con reducciones:"),r(),o(12,"span",125),a(13),r()(),o(14,"div",123)(15,"span",124),a(16,"Pisos que reciben redistribuci\xF3n:"),r(),o(17,"span",125),a(18),r()(),o(19,"div",123)(20,"span",124),a(21,"Total redistribuido:"),r(),o(22,"span",125),a(23),r()()()()),n&2){let e=t.ngIf,i=d(2);s(8),y(e.floorsWithAdjustments),s(5),y(e.floorsWithReductions),s(5),y(e.floorsReceivingRedistribution),s(5),y(i.formatCurrency(e.totalRedistributed))}}function Pe(n,t){if(n&1){let e=j();o(0,"div",36)(1,"div",17)(2,"h2",18),a(3,"\u{1F4CA} Distribuci\xF3n de Agua"),r(),o(4,"p",19),a(5,"Desglose detallado con redistribuci\xF3n autom\xE1tica"),r()(),o(6,"div",64)(7,"div",65)(8,"div",66),a(9,"\u{1F4B0}"),r(),o(10,"div",67)(11,"div",68),a(12),r(),o(13,"div",69),a(14,"Total Factura"),r()()(),o(15,"div",70)(16,"div",66),a(17,"\u{1F465}"),r(),o(18,"div",67)(19,"div",68),a(20),r(),o(21,"div",69),a(22,"Total Personas"),r()()(),o(23,"div",71)(24,"div",66),a(25,"\u{1F4A7}"),r(),o(26,"div",67)(27,"div",68),a(28),r(),o(29,"div",69),a(30,"Por Persona"),r()()(),m(31,_e,8,1,"div",72),r(),m(32,ye,6,1,"div",73),o(33,"div",37)(34,"div",38),a(35),r()(),o(36,"div",74)(37,"h3",75),a(38,"\u{1F3E2} Desglose por Piso"),r(),o(39,"div",76),m(40,De,32,15,"div",77),r()(),o(41,"div",78)(42,"div",79)(43,"div",80),a(44),r(),o(45,"div",81),a(46,"Total Final (Igual al inicial)"),r(),m(47,Ae,2,1,"div",82)(48,ke,2,1,"div",83),r(),o(49,"div",84),m(50,je,2,2,"span",85)(51,Ie,2,1,"span",85),r()(),m(52,ze,24,4,"div",86),o(53,"div",41)(54,"button",42),w("click",function(){b(e);let l=d();return h(l.onPreviousStep())}),o(55,"span",33),a(56,"\u2190"),r(),a(57," Editar Datos "),r(),o(58,"button",87),w("click",function(){b(e);let l=d();return h(l.exportResults())}),o(59,"span",33),a(60,"\u{1F4CA}"),r(),a(61," Exportar "),r(),o(62,"button",88),w("click",function(){b(e);let l=d();return h(l.resetCalculator())}),o(63,"span",33),a(64,"\u{1F504}"),r(),a(65," Nueva Calculaci\xF3n "),r()()()}if(n&2){let e=d();s(12),y(e.formatCurrency(e.calculation.totalAmount)),s(8),y(e.calculation.totalPeople),s(8),y(e.formatCurrency(e.calculation.baseAmountPerPerson)),s(3),c("ngIf",e.calculation.redistributionDetails&&e.calculation.redistributionDetails.totalRedistributed>0),s(),c("ngIf",e.calculation.redistributionDetails&&e.calculation.redistributionDetails.totalRedistributed>0),s(3),x(" ",e.getSuggestion()," "),s(5),c("ngForOf",e.calculation.floors),s(4),y(e.formatCurrency(e.calculation.finalTotal)),s(3),c("ngIf",e.calculation.totalAdjustments!==0),s(),c("ngIf",e.calculation.redistributionDetails&&e.calculation.redistributionDetails.totalRedistributed>0),s(2),c("ngIf",e.Math.abs(e.getTotalDifference())<=.01),s(),c("ngIf",e.Math.abs(e.getTotalDifference())>.01),s(),c("ngIf",e.getCalculationStats())}}var ae=class n{constructor(t,e){this.fb=t;this.router=e;this.aguaForm=this.fb.group({totalAmount:[null,[E.required,E.min(.01),this.currencyValidator]],numberOfFloors:[null,[E.required,E.min(1),E.max(20),E.pattern(/^\d+$/)]],floors:this.fb.array([])})}aguaForm;calculation=null;showResults=!1;isCalculating=!1;currentStep=1;maxSteps=3;debounceTimeout;ngOnInit(){this.setupFormSubscriptions()}ngOnDestroy(){this.debounceTimeout&&clearTimeout(this.debounceTimeout)}setupFormSubscriptions(){this.aguaForm.get("totalAmount")?.valueChanges.subscribe(()=>{this.currentStep===3&&this.calculation&&this.debounceCalculation()}),this.aguaForm.get("numberOfFloors")?.valueChanges.subscribe(()=>{this.currentStep===1&&this.onFieldChange("numberOfFloors")}),this.floorsFormArray.valueChanges.subscribe(()=>{this.currentStep===3&&this.calculation&&this.debounceCalculation()})}debounceCalculation(){clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(()=>{this.isStep2Valid()&&this.calculateWaterBill()},300)}currencyValidator(t){let e=t.value;return e?/^\d+(\.\d{1,2})?$/.test(e.toString())?null:{invalidCurrency:!0}:null}adjustmentValidator(t){let e=t.value;return e===null||e===""||e===0||/^-?\d+(\.\d{1,2})?$/.test(e.toString())?null:{invalidAdjustment:!0}}get floorsFormArray(){return this.aguaForm.get("floors")}get floorFormGroups(){return this.floorsFormArray.controls}get Math(){return Math}onNextStep(){this.currentStep===1&&this.isStep1Valid()?(this.generateFloorForms(),this.currentStep=2):this.currentStep===2&&this.isStep2Valid()&&(this.calculateWaterBill(),this.currentStep=3)}onPreviousStep(){this.currentStep>1&&(this.currentStep--,this.currentStep===1&&(this.showResults=!1,this.calculation=null))}isStep1Valid(){let t=this.aguaForm.get("totalAmount"),e=this.aguaForm.get("numberOfFloors");return!!(t?.valid&&e?.valid)}isStep2Valid(){return this.floorsFormArray.length===0?!1:this.floorsFormArray.controls.every(t=>{let e=t.get("people"),i=t.get("adjustment");return e?.valid&&i?.valid})}generateFloorForms(){let t=parseInt(this.aguaForm.get("numberOfFloors")?.value);for(;this.floorsFormArray.length!==0;)this.floorsFormArray.removeAt(0);for(let e=1;e<=t;e++){let i=this.fb.group({floorNumber:[e],people:[null,[E.required,E.min(1),E.max(20),E.pattern(/^\d+$/)]],adjustment:[0,[this.adjustmentValidator]],adjustmentReason:["",[E.maxLength(100)]]});this.floorsFormArray.push(i)}}calculateWithRedistribution(t,e){let i=e.reduce((u,g)=>u+parseInt(g.people),0),l=e.reduce((u,g)=>{let S=parseFloat(g.adjustment)||0;return u+(S>0?S:0)},0),A=(t-l)/i,f=e.map(u=>{let g=parseInt(u.people),S=A*g,oe=parseFloat(u.adjustment)||0;return{floorNumber:u.floorNumber,people:g,baseAmount:S,adjustment:oe,finalAmount:S,adjustmentReason:u.adjustmentReason?.trim()||"",redistributedAmount:0}}),v=f.reduce((u,g)=>u+(g.adjustment<0?Math.abs(g.adjustment):0),0),_=f.filter(u=>u.adjustment>=0),F=_.length>0?v/_.length:0;f.forEach(u=>{u.adjustment<0?(u.finalAmount=Math.max(0,u.baseAmount+u.adjustment),u.redistributedAmount=0):u.adjustment>0?(u.redistributedAmount=F,u.finalAmount=u.baseAmount+u.adjustment+F):(u.redistributedAmount=F,u.finalAmount=u.baseAmount+F)});let I={totalReduced:v,totalRedistributed:v,floorsWithReductions:f.filter(u=>u.adjustment<0).length,floorsReceivingRedistribution:_.length,redistributionPerFloor:F};return{floors:f,redistributionDetails:I}}calculateWaterBill(){this.isStep2Valid()&&(this.isCalculating=!0,setTimeout(()=>{try{let t=parseFloat(this.aguaForm.get("totalAmount")?.value),e=this.floorsFormArray.value,i=e.reduce((u,g)=>u+parseInt(g.people),0);if(i===0)throw new Error("Debe haber al menos una persona");let l=e.reduce((u,g)=>{let S=parseFloat(g.adjustment)||0;return u+(S>0?S:0)},0),A=(t-l)/i,{floors:f,redistributionDetails:v}=this.calculateWithRedistribution(t,e),_=f.reduce((u,g)=>u+g.adjustment,0),F=f.reduce((u,g)=>u+g.finalAmount,0);this.calculation={totalAmount:t,totalPeople:i,baseAmountPerPerson:A,floors:f,totalAdjustments:_,finalTotal:F,redistributionDetails:v},this.showResults=!0;let I=Math.abs(F-t);I>.01&&console.warn("Diferencia detectada en el total:",I)}catch(t){console.error("Error en el c\xE1lculo:",t),this.showErrorMessage("Error en el c\xE1lculo. Por favor, verifica los datos ingresados.")}finally{this.isCalculating=!1}},800))}showErrorMessage(t){console.error(t)}getErrorMessage(t,e){let i;if(e!==void 0?i=this.floorsFormArray.at(e)?.get(t):i=this.aguaForm.get(t),i?.errors&&(i?.touched||i?.dirty)){if(i.errors.required)return this.getRequiredMessage(t);if(i.errors.min)return this.getMinMessage(t,i.errors.min.min);if(i.errors.max)return this.getMaxMessage(t,i.errors.max.max);if(i.errors.pattern)return this.getPatternMessage(t);if(i.errors.invalidCurrency)return"Ingrese un monto v\xE1lido (ej: 150000.50)";if(i.errors.invalidAdjustment)return"Ingrese un valor num\xE9rico v\xE1lido";if(i.errors.maxlength)return"M\xE1ximo 100 caracteres permitidos"}return""}getRequiredMessage(t){return{totalAmount:"El monto total es requerido",numberOfFloors:"El n\xFAmero de pisos es requerido",people:"La cantidad de personas es requerida"}[t]||"Este campo es requerido"}getMinMessage(t,e){return{totalAmount:`El monto debe ser mayor a $${e}`,numberOfFloors:`Debe ser al menos ${e} piso`,people:`Debe haber al menos ${e} persona`}[t]||`Valor m\xEDnimo: ${e}`}getMaxMessage(t,e){return{numberOfFloors:`M\xE1ximo ${e} pisos permitidos`,people:`M\xE1ximo ${e} personas por piso`}[t]||`Valor m\xE1ximo: ${e}`}getPatternMessage(t){return{totalAmount:"Ingrese un monto v\xE1lido (ej: 150000.50)",numberOfFloors:"Ingrese solo n\xFAmeros enteros",people:"Ingrese solo n\xFAmeros enteros",adjustment:"Ingrese un valor num\xE9rico v\xE1lido"}[t]||"Formato inv\xE1lido"}hasError(t,e){let i;return e!==void 0?i=this.floorsFormArray.at(e)?.get(t):i=this.aguaForm.get(t),!!(i?.errors&&(i?.touched||i?.dirty))}formatCurrency(t){return isNaN(t)||t===null||t===void 0?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:2}).format(t)}resetCalculator(){this.aguaForm.dirty||this.calculation?confirm("\xBFEst\xE1s seguro de que quieres reiniciar la calculadora? Se perder\xE1n todos los datos.")&&this.performReset():this.performReset()}performReset(){for(this.aguaForm.reset(),this.calculation=null,this.showResults=!1,this.isCalculating=!1,this.currentStep=1;this.floorsFormArray.length!==0;)this.floorsFormArray.removeAt(0);this.aguaForm.patchValue({totalAmount:null,numberOfFloors:null}),this.aguaForm.markAsUntouched(),this.aguaForm.markAsPristine()}getTotalDifference(){return this.calculation?this.calculation.finalTotal-this.calculation.totalAmount:0}getProgressPercentage(){return Math.round(this.currentStep/this.maxSteps*100)}exportResults(){if(this.calculation)try{let t={fecha:new Date().toISOString(),timestamp:Date.now(),calculo:this.calculation,resumen:{totalFactura:this.formatCurrency(this.calculation.totalAmount),totalPersonas:this.calculation.totalPeople,promedioPorPersona:this.formatCurrency(this.calculation.baseAmountPerPerson),totalAjustes:this.formatCurrency(this.calculation.totalAdjustments),totalFinal:this.formatCurrency(this.calculation.finalTotal),redistribucionTotal:this.calculation.redistributionDetails?this.formatCurrency(this.calculation.redistributionDetails.totalRedistributed):"$0"}},e=JSON.stringify(t,null,2),i=new Blob([e],{type:"application/json"}),l=URL.createObjectURL(i),p=document.createElement("a");p.href=l,p.download=`calculo-agua-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(l),console.log("Datos exportados:",t)}catch(t){console.error("Error al exportar:",t),alert("Error al exportar los datos. Por favor, intenta nuevamente.")}}onFieldChange(t,e){setTimeout(()=>{e!==void 0?(this.floorsFormArray.at(e)?.get(t)?.markAsTouched(),this.validateFloorLogic(e)):(this.aguaForm.get(t)?.markAsTouched(),this.validateStep1Logic(t))},150)}validateFloorLogic(t){let e=this.floorsFormArray.at(t);if(!e)return;let i=e.get("people")?.value,l=e.get("adjustment")?.value;if(i&&l&&this.aguaForm.get("totalAmount")?.value){let f=parseFloat(this.aguaForm.get("totalAmount")?.value)/(this.getCurrentTotalPeople()||1)*i;Math.abs(l)>f*.5&&console.warn(`Ajuste alto detectado en piso ${t+1}`)}}validateStep1Logic(t){if(t==="numberOfFloors"){let e=this.aguaForm.get("numberOfFloors")?.value;e&&e>10&&console.log("Edificio grande detectado, considera revisar la distribuci\xF3n")}if(t==="totalAmount"){let e=this.aguaForm.get("totalAmount")?.value;e&&e>1e6&&console.log("Monto alto detectado, verifica la cifra")}}getCurrentTotalPeople(){return this.floorsFormArray.controls.reduce((t,e)=>{let i=parseInt(e.get("people")?.value)||0;return t+i},0)}getSuggestion(){if(!this.calculation)return"";let t=Math.abs(this.getTotalDifference());return t<=1?"\u2705 La distribuci\xF3n est\xE1 perfectamente balanceada con redistribuci\xF3n autom\xE1tica":`\u26A0\uFE0F Diferencia m\xEDnima de ${this.formatCurrency(t)} debido a redondeos`}getRedistributionInfo(){if(!this.calculation?.redistributionDetails)return"";let t=this.calculation.redistributionDetails;return t.totalReduced===0?"Sin redistribuciones necesarias":`${this.formatCurrency(t.totalReduced)} redistribuidos entre ${t.floorsReceivingRedistribution} pisos (${this.formatCurrency(t.redistributionPerFloor)} c/u)`}getCalculationStats(){if(!this.calculation)return null;let t=this.calculation.floors,e=t.map(i=>i.adjustment).filter(i=>i!==0);return{floorsWithAdjustments:t.filter(i=>i.adjustment!==0).length,floorsWithReductions:t.filter(i=>i.adjustment<0).length,floorsReceivingRedistribution:t.filter(i=>(i.redistributedAmount||0)>0).length,averageAdjustment:e.length>0?e.reduce((i,l)=>i+l,0)/e.length:0,maxAdjustment:e.length>0?Math.max(...e):0,minAdjustment:e.length>0?Math.min(...e):0,totalPositiveAdjustments:t.filter(i=>i.adjustment>0).reduce((i,l)=>i+l.adjustment,0),totalNegativeAdjustments:t.filter(i=>i.adjustment<0).reduce((i,l)=>i+Math.abs(l.adjustment),0),totalRedistributed:this.calculation.redistributionDetails?.totalRedistributed||0}}getFloorBreakdown(t){let e=`Base: ${this.formatCurrency(t.baseAmount)}`;if(t.adjustment!==0){let i=t.adjustment>0?"+":"";e+=` | Ajuste: ${i}${this.formatCurrency(t.adjustment)}`}return t.redistributedAmount&&t.redistributedAmount>0&&(e+=` | Redistribuci\xF3n: +${this.formatCurrency(t.redistributedAmount)}`),e}goToMenu(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||n)(V(ne),V(U))};static \u0275cmp=N({type:n,selectors:[["app-agua"]],decls:33,vars:15,consts:[[1,"back-menu-btn",3,"click"],[1,"agua-calculator-container"],[1,"calculator-card"],[1,"progress-container"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-steps"],[1,"step"],[1,"step-number"],[1,"step-label"],[1,"header"],[1,"header-icon"],[1,"header-title"],[1,"header-subtitle"],["class","step-content fade-in",4,"ngIf"],["class","step-content",4,"ngIf"],[1,"step-content","fade-in"],[1,"step-header"],[1,"step-title"],[1,"step-description"],[1,"agua-form",3,"formGroup"],[1,"form-group"],["for","totalAmount",1,"form-label"],[1,"input-wrapper"],[1,"input-icon"],["id","totalAmount","type","number","formControlName","totalAmount","placeholder","Ej: 250,000","step","0.01","min","0",1,"form-input",3,"blur","input"],["class","error-message",4,"ngIf"],[1,"field-hint"],[1,"hint-icon"],["for","numberOfFloors",1,"form-label"],["id","numberOfFloors","type","number","formControlName","numberOfFloors","placeholder","Ej: 4","min","1","max","20",1,"form-input",3,"blur","input"],[1,"form-actions"],["type","button",1,"btn-primary",3,"click","disabled"],[1,"btn-icon"],[1,"error-message"],[1,"error-icon"],[1,"step-content"],[1,"suggestion-card"],[1,"suggestion-content"],[1,"floors-container"],["class","floor-card",3,"formGroup",4,"ngFor","ngForOf"],[1,"button-group"],["type","button",1,"prev-btn",3,"click"],["type","button",1,"calculate-btn",3,"click","disabled"],["class","btn-content",4,"ngIf"],["class","loading-content",4,"ngIf"],[1,"floor-card",3,"formGroup"],[1,"floor-header"],[1,"floor-title"],[1,"floor-icon"],[1,"floor-status"],[4,"ngIf"],[1,"floor-content"],[1,"form-label"],[1,"input-container"],["type","number","formControlName","people","placeholder","2","min","1","max","20",1,"form-input","small",3,"blur","input"],[1,"label-help"],[1,"currency-symbol"],["type","number","formControlName","adjustment","placeholder","0","step","0.01",1,"form-input","small",3,"blur","input"],["class","field-hint",4,"ngIf"],["type","text","formControlName","adjustmentReason","placeholder","Ej: Mayor consumo por jard\xEDn","maxlength","100",1,"form-input",3,"blur"],[1,"btn-content"],[1,"loading-content"],[1,"spinner"],[1,"summary-cards"],[1,"summary-card","primary"],[1,"summary-icon"],[1,"summary-content"],[1,"summary-value"],[1,"summary-label"],[1,"summary-card","secondary"],[1,"summary-card","accent"],["class","summary-card accent",4,"ngIf"],["class","suggestion-card",4,"ngIf"],[1,"floors-breakdown"],[1,"breakdown-title"],[1,"floors-results"],["class","floor-result-card",3,"animation-delay",4,"ngFor","ngForOf"],[1,"final-total"],[1,"total-display"],[1,"total-amount"],[1,"total-label"],["class","total-adjustments",4,"ngIf"],["style","font-size: 12px; color: rgba(255,255,255,0.8); font-style: italic; margin-top: 4px;",4,"ngIf"],[2,"margin-top","12px","text-align","center"],["style","color: rgba(255,255,255,0.9); font-weight: 500;",4,"ngIf"],["style","background: #f8f9fa; border-radius: 12px; padding: 16px; margin-top: 20px;",4,"ngIf"],["type","button",1,"export-btn",3,"click"],["type","button",1,"reset-btn",3,"click"],[1,"floor-result-card"],[1,"floor-result-header"],[1,"floor-info"],[1,"floor-number"],[1,"floor-emoji"],[1,"people-count"],[2,"display","flex","gap","8px","margin-top","4px"],["style","background: #ffebee; color: #c62828; padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;",4,"ngIf"],["style","background: #e8f5e8; color: #2e7d32; padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: 500;",4,"ngIf"],[1,"floor-total"],[1,"floor-breakdown"],[1,"breakdown-row"],[1,"breakdown-label"],[1,"breakdown-value"],["class","breakdown-row adjustment",4,"ngIf"],["class","breakdown-row","style","background: #e8f5e8; border-radius: 6px; padding: 8px; margin: 4px 0;",4,"ngIf"],[1,"breakdown-row","total"],[2,"margin-top","8px","padding","8px","background","#f8f9fa","border-radius","6px","border-left","3px solid #6c757d"],[2,"color","#6c757d","font-size","12px","line-height","1.4"],[2,"background","#ffebee","color","#c62828","padding","2px 8px","border-radius","12px","font-size","12px","font-weight","500"],[2,"background","#e8f5e8","color","#2e7d32","padding","2px 8px","border-radius","12px","font-size","12px","font-weight","500"],[1,"breakdown-row","adjustment"],[1,"adjustment-type"],["class","adjustment-reason",4,"ngIf"],[1,"adjustment-reason"],[1,"breakdown-row",2,"background","#e8f5e8","border-radius","6px","padding","8px","margin","4px 0"],[1,"breakdown-label",2,"color","#2e7d32","font-weight","500"],[1,"breakdown-value",2,"color","#2e7d32 !important","font-weight","600"],[1,"total-adjustments"],[2,"font-size","12px","color","rgba(255,255,255,0.8)","font-style","italic","margin-top","4px"],[2,"color","rgba(255,255,255,0.9)","font-weight","500"],[2,"background","#f8f9fa","border-radius","12px","padding","16px","margin-top","20px"],[2,"margin","0 0 12px 0","color","#495057"],[2,"display","grid","grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))","gap","12px"],[2,"display","flex","justify-content","space-between","align-items","center","padding","8px 12px","background","white","border-radius","6px","border","1px solid #dee2e6"],[2,"color","#6c757d","font-size","14px"],[2,"font-weight","600","color","#495057"]],template:function(e,i){e&1&&(o(0,"button",0),w("click",function(){return i.goToMenu()}),a(1,` \u2190 Men\xFA
`),r(),o(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),O(6,"div",5),r(),o(7,"div",6)(8,"div",7)(9,"span",8),a(10,"1"),r(),o(11,"span",9),a(12,"Datos B\xE1sicos"),r()(),o(13,"div",7)(14,"span",8),a(15,"2"),r(),o(16,"span",9),a(17,"Personas por Piso"),r()(),o(18,"div",7)(19,"span",8),a(20,"3"),r(),o(21,"span",9),a(22,"Resultados"),r()()()(),o(23,"div",10)(24,"div",11),a(25,"\u{1F4A7}"),r(),o(26,"h1",12),a(27,"Calculadora de Agua"),r(),o(28,"p",13),a(29,"Distribuci\xF3n proporcional con redistribuci\xF3n autom\xE1tica de ajustes"),r()(),m(30,de,34,8,"div",14)(31,xe,20,7,"div",15)(32,Pe,66,13,"div",15),r()()),e&2&&(s(6),M("width",i.getProgressPercentage(),"%"),s(2),C("active",i.currentStep>=1)("completed",i.currentStep>1),s(5),C("active",i.currentStep>=2)("completed",i.currentStep>2),s(5),C("active",i.currentStep>=3),s(12),c("ngIf",i.currentStep===1),s(),c("ngIf",i.currentStep===2),s(),c("ngIf",i.currentStep===3&&i.calculation))},dependencies:[L,B,G,ie,J,W,H,K,Q,re,te,ee,X,Z],styles:[`:root{--primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);--secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);--success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);--background-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);--primary: #667eea;--primary-light: #8b9bf5;--secondary: #764ba2;--accent: #4facfe;--success: #00f2fe;--warning: #ff9a9e;--error: #ffa085;--white: #ffffff;--gray-50: #fafafa;--gray-100: #f5f5f5;--gray-200: #eeeeee;--gray-300: #e0e0e0;--gray-400: #bdbdbd;--gray-500: #9e9e9e;--gray-600: #757575;--gray-700: #616161;--gray-800: #424242;--gray-900: #212121;--font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;--font-size-xs: .75rem;--font-size-sm: .875rem;--font-size-base: 1rem;--font-size-lg: 1.125rem;--font-size-xl: 1.25rem;--font-size-2xl: 1.5rem;--font-size-3xl: 1.875rem;--font-size-4xl: 2.25rem;--space-1: .25rem;--space-2: .5rem;--space-3: .75rem;--space-4: 1rem;--space-5: 1.25rem;--space-6: 1.5rem;--space-8: 2rem;--space-10: 2.5rem;--space-12: 3rem;--space-16: 4rem;--space-20: 5rem;--border-radius: .75rem;--border-radius-lg: 1rem;--border-radius-xl: 1.5rem;--border-radius-2xl: 2rem;--shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, .05);--shadow: 0 1px 3px 0 rgba(0, 0, 0, .1), 0 1px 2px 0 rgba(0, 0, 0, .06);--shadow-md: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);--shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, .1), 0 4px 6px -2px rgba(0, 0, 0, .05);--shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, .1), 0 10px 10px -5px rgba(0, 0, 0, .04);--shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, .25)}*{margin:0;padding:0;box-sizing:border-box}@keyframes fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}@keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes glow{0%,to{box-shadow:0 0 5px #667eea80}50%{box-shadow:0 0 20px #667eeacc}}.agua-calculator-container{min-height:100vh;background:var(--background-gradient);display:flex;align-items:center;justify-content:center;padding:var(--space-8);font-family:var(--font-family);line-height:1.6;color:var(--gray-800)}.calculator-card{background:#fffffffa;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:var(--border-radius-2xl);box-shadow:var(--shadow-2xl);padding:var(--space-12);width:100%;max-width:1200px;position:relative;overflow:hidden;transition:all .3s ease}.calculator-card:before{content:"";position:absolute;top:0;left:0;right:0;height:6px;background:var(--primary-gradient);border-radius:var(--border-radius-2xl) var(--border-radius-2xl) 0 0}.progress-container{margin-bottom:var(--space-16)}.progress-bar{height:8px;background:var(--gray-200);border-radius:var(--border-radius);overflow:hidden;margin-bottom:var(--space-8);position:relative}.progress-fill{height:100%;background:var(--primary-gradient);border-radius:var(--border-radius);transition:width .8s cubic-bezier(.4,0,.2,1);position:relative}.progress-fill:after{content:"";position:absolute;top:0;right:0;bottom:0;width:30px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4));animation:pulse 2s infinite}.progress-steps{display:flex;justify-content:space-between;align-items:center;max-width:600px;margin:0 auto}.step{display:flex;flex-direction:column;align-items:center;opacity:.4;transition:all .4s ease}.step.active{opacity:1;transform:scale(1.1)}.step.completed{opacity:1}.step-number{width:50px;height:50px;border-radius:50%;background:var(--gray-300);color:var(--gray-600);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:var(--font-size-lg);margin-bottom:var(--space-3);transition:all .4s ease}.step.active .step-number{background:var(--primary-gradient);color:#fff;box-shadow:0 0 20px #667eea66;animation:bounce 2s infinite}.step.completed .step-number{background:var(--success-gradient);color:#fff}.step-label{font-size:var(--font-size-sm);font-weight:600;color:var(--gray-600);text-align:center;transition:color .3s ease}.step.active .step-label{color:var(--primary)}.header{text-align:center;margin-bottom:var(--space-16);padding-top:var(--space-8)}.header-icon{font-size:4rem;margin-bottom:var(--space-6);animation:pulse 3s infinite}.header-title{font-size:var(--font-size-4xl);font-weight:800;background:var(--primary-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:var(--space-4);line-height:1.2}.header-subtitle{font-size:var(--font-size-xl);color:var(--gray-600);max-width:600px;margin:0 auto;line-height:1.5}.step-content{animation:fadeInUp .6s ease-out}.fade-in{animation:fadeInUp .4s ease}.step-header{text-align:center;margin-bottom:var(--space-12)}.step-title{font-size:var(--font-size-3xl);font-weight:700;color:var(--gray-800);margin-bottom:var(--space-4)}.step-description{font-size:var(--font-size-lg);color:var(--gray-600)}.agua-form{display:flex;flex-direction:column;gap:var(--space-8)}.form-group{display:flex;flex-direction:column;gap:var(--space-3)}.form-label{font-weight:600;font-size:var(--font-size-lg);color:var(--gray-800);display:flex;align-items:center;gap:var(--space-3)}.label-help{font-size:var(--font-size-sm);font-weight:400;color:var(--gray-500);margin-left:var(--space-2)}.input-wrapper{position:relative;display:flex;align-items:center}.input-icon{position:absolute;left:var(--space-5);color:var(--gray-500);font-weight:600;font-size:var(--font-size-lg);pointer-events:none;z-index:1}.form-input{width:100%;padding:var(--space-5) var(--space-6);padding-left:var(--space-12);border:2px solid var(--gray-300);border-radius:var(--border-radius-lg);font-size:var(--font-size-lg);font-weight:500;background:var(--white);transition:all .3s ease;box-shadow:var(--shadow-sm);color:var(--gray-800)}.form-input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 4px #667eea1a;transform:translateY(-2px)}.form-input::placeholder{color:var(--gray-400);font-weight:400}.input-container{position:relative}.input-container .form-input{padding-left:var(--space-5)}.input-container .form-input.small{font-size:var(--font-size-base);padding:var(--space-4) var(--space-5)}.currency-symbol{position:absolute;left:var(--space-4);top:50%;transform:translateY(-50%);color:var(--gray-500);font-weight:600;pointer-events:none;z-index:1}.input-container .form-input:has(~.currency-symbol){padding-left:var(--space-10)}.input-wrapper.error .form-input,.input-container.error .form-input{border-color:var(--error);background:#ffa0850d}.input-container.success .form-input{border-color:var(--success);box-shadow:0 0 0 4px #4facfe1a}.input-container.success:after{content:"\\2713";position:absolute;top:50%;right:var(--space-4);transform:translateY(-50%);color:var(--success);font-weight:700;font-size:var(--font-size-lg)}.error-message{display:flex;align-items:center;gap:var(--space-2);font-size:var(--font-size-base);font-weight:500;color:var(--error);animation:fadeInUp .3s ease}.error-icon{font-size:var(--font-size-base)}.field-hint{display:flex;align-items:center;gap:var(--space-2);font-size:var(--font-size-sm);color:var(--gray-500)}.hint-icon{font-size:var(--font-size-sm)}.form-actions{display:flex;justify-content:flex-end;margin-top:var(--space-8)}.btn-primary{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-5) var(--space-8);font-size:var(--font-size-lg);font-weight:700;border:none;border-radius:var(--border-radius-lg);background:var(--primary-gradient);color:#fff;cursor:pointer;transition:all .3s ease;box-shadow:var(--shadow-lg);text-transform:uppercase;letter-spacing:1px}.btn-primary:hover:enabled{transform:translateY(-3px);box-shadow:var(--shadow-xl)}.btn-primary:active:enabled{transform:translateY(-1px)}.btn-primary:disabled{background:var(--gray-300);color:var(--gray-500);cursor:not-allowed;transform:none;box-shadow:var(--shadow-sm)}.btn-icon{font-size:var(--font-size-lg)}.floors-container{display:grid;gap:var(--space-6);margin-bottom:var(--space-12)}.floor-card{background:var(--white);border:2px solid var(--gray-200);border-radius:var(--border-radius-xl);padding:var(--space-8);transition:all .3s ease;box-shadow:var(--shadow-md);position:relative;overflow:hidden}.floor-card:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:var(--secondary-gradient)}.floor-card:hover{border-color:var(--primary);transform:translateY(-5px);box-shadow:var(--shadow-xl)}.floor-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-6)}.floor-title{display:flex;align-items:center;gap:var(--space-3);font-size:var(--font-size-xl);font-weight:700;color:var(--gray-800)}.floor-icon{font-size:var(--font-size-2xl)}.floor-status{font-size:var(--font-size-2xl);transition:all .3s ease}.floor-status.valid{animation:bounce 1s ease-in-out}.floor-content{display:grid;grid-template-columns:1fr 1fr;gap:var(--space-6)}.floor-content .form-group:last-child{grid-column:1 / -1}.button-group{display:flex;gap:var(--space-4);margin-top:var(--space-12);flex-wrap:wrap}.prev-btn,.calculate-btn{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-5) var(--space-8);font-size:var(--font-size-lg);font-weight:700;border:none;border-radius:var(--border-radius-lg);cursor:pointer;transition:all .3s ease;box-shadow:var(--shadow-md)}.prev-btn{background:var(--gray-200);color:var(--gray-700)}.prev-btn:hover{background:var(--gray-300);transform:translateY(-2px);box-shadow:var(--shadow-lg)}.calculate-btn{background:var(--success-gradient);color:#fff;flex:1;min-width:250px;justify-content:center}.calculate-btn:hover:not(:disabled){transform:translateY(-3px);box-shadow:var(--shadow-xl)}.calculate-btn:disabled{background:var(--gray-300);color:var(--gray-500);cursor:not-allowed;transform:none}.calculate-btn.loading{pointer-events:none}.btn-content,.loading-content{display:flex;align-items:center;gap:var(--space-3)}.spinner{width:24px;height:24px;border:3px solid rgba(255,255,255,.3);border-top:3px solid white;border-radius:50%;animation:spin 1s linear infinite}.summary-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:var(--space-6);margin-bottom:var(--space-12)}.summary-card{display:flex;align-items:center;gap:var(--space-6);padding:var(--space-8);border-radius:var(--border-radius-xl);transition:all .3s ease;position:relative;overflow:hidden;box-shadow:var(--shadow-lg)}.summary-card:hover{transform:translateY(-5px);box-shadow:var(--shadow-xl)}.summary-card.primary{background:var(--primary-gradient);color:#fff}.summary-card.secondary{background:var(--secondary-gradient);color:#fff}.summary-card.accent{background:var(--success-gradient);color:#fff}.summary-icon{font-size:3rem;opacity:.9}.summary-content{flex:1}.summary-value{font-size:var(--font-size-3xl);font-weight:800;margin-bottom:var(--space-2);line-height:1.2}.summary-label{font-size:var(--font-size-base);opacity:.9;text-transform:uppercase;letter-spacing:1px;font-weight:600}.suggestion-card{background:linear-gradient(135deg,#f0f9ff,#e0f2fe);border:2px solid rgba(79,172,254,.3);border-radius:var(--border-radius-lg);padding:var(--space-6);margin-bottom:var(--space-12);text-align:center;box-shadow:var(--shadow-sm)}.suggestion-content{color:var(--gray-800);font-size:var(--font-size-lg);font-weight:600}.balance-alert{display:flex;align-items:center;gap:var(--space-4);padding:var(--space-6);background:#ff9a9e1a;border:2px solid var(--warning);border-radius:var(--border-radius-lg);margin-bottom:var(--space-12);animation:glow 2s infinite}.alert-icon{font-size:var(--font-size-2xl)}.alert-content{flex:1;color:var(--gray-800);font-size:var(--font-size-lg);font-weight:600}.auto-balance-btn{padding:var(--space-3) var(--space-6);background:var(--warning);color:#fff;border:none;border-radius:var(--border-radius);font-size:var(--font-size-base);font-weight:700;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:var(--space-2)}.auto-balance-btn:hover{background:#ff9a9ecc;transform:translateY(-2px)}.floors-breakdown{margin-bottom:var(--space-16)}.breakdown-title{font-size:var(--font-size-2xl);font-weight:700;color:var(--gray-800);text-align:center;margin-bottom:var(--space-8)}.floors-results{display:grid;gap:var(--space-6)}.floor-result-card{background:var(--white);border:2px solid var(--gray-200);border-radius:var(--border-radius-xl);padding:var(--space-8);transition:all .3s ease;box-shadow:var(--shadow-md);animation:fadeInUp .5s ease forwards}.floor-result-card:hover{border-color:var(--primary);transform:translateY(-3px);box-shadow:var(--shadow-xl)}.floor-result-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-6);padding-bottom:var(--space-6);border-bottom:2px solid var(--gray-200)}.floor-info{display:flex;flex-direction:column;gap:var(--space-2)}.floor-number{font-size:var(--font-size-xl);font-weight:700;color:var(--gray-800);display:flex;align-items:center;gap:var(--space-3)}.floor-emoji{font-size:var(--font-size-2xl)}.people-count{font-size:var(--font-size-sm);color:var(--gray-600);text-transform:uppercase;letter-spacing:1px;font-weight:600}.floor-total{font-size:var(--font-size-3xl);font-weight:800;color:var(--primary)}.floor-breakdown{display:grid;gap:var(--space-4)}.breakdown-row{display:flex;justify-content:space-between;align-items:center;padding:var(--space-3) 0;font-size:var(--font-size-base)}.breakdown-row.adjustment{color:var(--gray-600)}.breakdown-row.total{border-top:2px solid var(--gray-200);margin-top:var(--space-4);padding-top:var(--space-4);font-weight:700;font-size:var(--font-size-lg)}.breakdown-label,.adjustment-type{font-weight:600}.adjustment-reason{display:block;font-size:var(--font-size-sm);color:var(--gray-500);font-style:italic;margin-top:var(--space-1);font-weight:400}.breakdown-value{font-weight:700}.breakdown-value.positive{color:var(--success)}.breakdown-value.negative{color:var(--error)}.final-total{background:var(--primary-gradient);color:#fff;text-align:center;padding:var(--space-16);border-radius:var(--border-radius-2xl);margin-bottom:var(--space-16);position:relative;overflow:hidden;box-shadow:var(--shadow-2xl)}.final-total:before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,.1) 0%,transparent 70%);animation:pulse 4s infinite}.total-display{position:relative;z-index:1}.total-amount{font-size:4rem;font-weight:900;margin-bottom:var(--space-4);text-shadow:2px 2px 4px rgba(0,0,0,.1);line-height:1.1}.total-label{font-size:var(--font-size-xl);opacity:.9;text-transform:uppercase;letter-spacing:2px;margin-bottom:var(--space-4);font-weight:700}.total-adjustments{font-size:var(--font-size-base);opacity:.8;font-style:italic}.reset-btn,.export-btn{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-4) var(--space-6);font-size:var(--font-size-base);font-weight:600;border:2px solid var(--gray-300);border-radius:var(--border-radius-lg);background:var(--white);color:var(--gray-700);cursor:pointer;transition:all .3s ease}.reset-btn:hover{border-color:var(--error);color:var(--error);transform:translateY(-2px)}.export-btn{background:var(--success-gradient);color:#fff;border:none}.export-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}@media (max-width: 768px){.calculator-card{padding:var(--space-6);margin:var(--space-4);max-width:100%}.header-title{font-size:var(--font-size-3xl)}.header-icon{font-size:3rem}.step-title{font-size:var(--font-size-2xl)}.summary-cards{grid-template-columns:1fr}.summary-value{font-size:var(--font-size-2xl)}.floor-content{grid-template-columns:1fr}.button-group{flex-direction:column}.calculate-btn{min-width:auto}.total-amount{font-size:var(--font-size-4xl)}.progress-steps{flex-direction:column;gap:var(--space-4)}.step{flex-direction:row;gap:var(--space-4)}.step-number{margin-bottom:0}.floor-result-header{flex-direction:column;align-items:flex-start;gap:var(--space-3)}.balance-alert{flex-direction:column;text-align:center}.auto-balance-btn{margin-left:0;margin-top:var(--space-4)}}@media (max-width: 480px){.agua-calculator-container,.calculator-card{padding:var(--space-4)}.header-title{font-size:var(--font-size-2xl)}.total-amount{font-size:var(--font-size-3xl)}.form-input{font-size:var(--font-size-base)}.summary-card{padding:var(--space-6)}.summary-icon{font-size:var(--font-size-2xl)}.floor-card,.floor-result-card{padding:var(--space-6)}}@media (prefers-reduced-motion: reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.form-input:focus,.btn-primary:focus,.calculate-btn:focus,.prev-btn:focus,.reset-btn:focus,.export-btn:focus,.auto-balance-btn:focus{outline:none;box-shadow:0 0 0 4px #667eea33}.form-input:hover:not(:disabled){border-color:var(--primary-light)}.floor-card:focus-within{border-color:var(--primary);box-shadow:var(--shadow-lg)}.calculator-card:hover{box-shadow:0 30px 60px -12px #00000040}.back-menu-btn{position:fixed;top:20px;left:20px;background-color:#0061a8;color:#fff;border:none;border-radius:8px;padding:10px 16px;font-size:16px;cursor:pointer;z-index:1000;box-shadow:0 2px 6px #0000004d;transition:background-color .3s,transform .3s;animation:slideIn .5s ease-out forwards;opacity:0}.back-menu-btn:hover{background-color:#004c7a;transform:scale(1.1)}
`],encapsulation:2,data:{animation:[P("fadeIn",[T(":enter",[k({opacity:0,transform:"translateY(30px)"}),R("600ms ease-out",k({opacity:1,transform:"translateY(0)"}))])]),P("slideIn",[T(":enter",[$(".floor-card",[k({opacity:0,transform:"translateY(50px)"}),Y(100,[R("400ms ease-out",k({opacity:1,transform:"translateY(0)"}))])],{optional:!0})])])]}})};export{ae as AguaComponent};
